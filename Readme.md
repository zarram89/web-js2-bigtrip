# Задача 9: Фильтрация и создание точек (module7-task1)

В этом задании мы значительно расширили функциональность приложения, добавив возможность фильтрации, создания и удаления точек маршрута.

## Описание задачи
1.  **Модель данных**:
    *   Добавить методы `updatePoint`, `addPoint`, `deletePoint` в `PointsModel`.
    *   Реализовать паттерн "Наблюдатель" для синхронизации данных.
2.  **Фильтрация**:
    *   Создать `FilterModel` для хранения текущего фильтра.
    *   Создать `FilterPresenter` для управления компонентом фильтров.
    *   Связать изменение фильтра с обновлением списка точек в `BoardPresenter`.
3.  **CRUD (Create, Read, Update, Delete)**:
    *   Реализовать удаление точки через форму редактирования.
    *   Реализовать создание новой точки по кнопке "New Event".
    *   Обеспечить сброс фильтров и сортировки при создании новой точки.
4.  **Безопасность**:
    *   Ограничить ввод пункта назначения списком доступных городов.
    *   Разрешить ввод в поле цены только чисел.

# Решение Задачи 9 (module7-task1)

Для выполнения задачи я выполнил следующие действия:

### 1. Обновление Модели
*   **`PointsModel`**:
    *   Унаследовал от `Observable`.
    *   Реализовал методы `updatePoint`, `addPoint`, `deletePoint`, которые изменяют массив точек и уведомляют подписчиков.
*   **`FilterModel`**:
    *   Создал модель для хранения текущего типа фильтра (`EVERYTHING`, `FUTURE`, `PRESENT`, `PAST`).

### 2. Реализация Фильтрации
*   **`FilterPresenter`**:
    *   Инициализирует `FilterView`.
    *   Подписывается на изменения в `PointsModel` и `FilterModel`.
    *   Пересчитывает количество доступных точек для каждого фильтра.
*   **`BoardPresenter`**:
    *   В геттере `points` теперь применяется текущий фильтр из `FilterModel`.
    *   При изменении фильтра (`UpdateType.MAJOR`) список точек перерисовывается, сортировка сбрасывается.

### 3. Создание и Удаление
*   **`NewPointPresenter`**:
    *   Создал презентер для управления формой создания новой точки.
    *   Обрабатывает сохранение (добавление точки) и отмену (закрытие формы).
*   **`EditPointView`**:
    *   Добавил обработчик для кнопки "Delete".
    *   Добавил валидацию: цена приводится к числу, пункт назначения проверяется на наличие в списке.
*   **`PointPresenter`**:
    *   Связал действия пользователя (`UserAction`) с методами модели через `handleViewAction`.

### 4. Точка входа и Связи
*   В `main.js` инициализировал `FilterModel` и `FilterPresenter`.
*   Настроил кнопку "New Event":
    *   При клике вызывается `boardPresenter.createPoint()`.
    *   Кнопка блокируется, пока открыта форма создания.
    *   Форма закрывается по кнопке "Cancel" или `Esc`, разблокируя кнопку "New Event".

### 5. Проверка
*   Проект собирается без ошибок.
*   Фильтры работают корректно, скрывая пустые категории.
*   Создание новой точки добавляет её в список.
*   Удаление точки убирает её из списка.
*   Редактирование сохраняет изменения.
